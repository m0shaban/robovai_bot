{% extends "base.html" %} {% block title %}ุงูุญููุงุช ุงูุฅุนูุงููุฉ - RoboVAI{%
endblock %} {% block content %}
<div class="grid lg:grid-cols-3 gap-6">
  <div class="lg:col-span-2 glass-card p-6">
    <div class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-2xl font-bold text-slate-50">
          ๐ข ุงูุญููุงุช ุงูุฅุนูุงููุฉ (Broadcasts)
        </h1>
        <p class="text-slate-400 text-sm mt-1">
          ุฃุฑุณู ุฑุณุงุฆู ุฌูุงุนูุฉ ูุนููุงุฆู ุนุจุฑ ูุงุชุณุงุจ ูุชูููุฌุฑุงู
        </p>
      </div>
    </div>

    <div class="mb-6">
      <label class="label">ุงุฎุชุฑ ุงููุดุฑูุน</label>
      <select
        id="tenant_select"
        class="select-field"
        onchange="loadBroadcasts()"
      >
        <option value="">-- ุงุฎุชุฑ ูุดุฑูุนุงู --</option>
        {% for tenant in tenants %}
        <option value="{{ tenant.id }}">{{ tenant.name }}</option>
        {% endfor %}
      </select>
    </div>

    <div id="broadcast-rows">
      <div class="text-center py-12 text-slate-400">
        <div class="text-5xl mb-4">๐ข</div>
        <p>ุงุฎุชุฑ ูุดุฑูุนุงู ูุนุฑุถ ุงูุญููุงุช</p>
      </div>
    </div>
  </div>

  <div class="glass-card p-6">
    <h2 class="text-xl font-bold text-slate-50 mb-4">โ ุฅูุดุงุก ุญููุฉ ุฌุฏูุฏุฉ</h2>

    <form
      hx-post="/ui/broadcasts/create"
      hx-target="#broadcast-rows"
      hx-on::after-request="this.reset()"
    >
      <input type="hidden" id="form_tenant_id" name="tenant_id" />

      <div class="mb-4">
        <label class="label">ุงุณู ุงูุญููุฉ</label>
        <input
          type="text"
          name="name"
          placeholder="ูุซูุงู: ุนุฑูุถ ุงูุฌูุนุฉ ุงูุจูุถุงุก"
          required
          class="input-field"
        />
      </div>

      <div class="mb-4">
        <label class="label">ุงูููุงุฉ ุงููุณุชูุฏูุฉ</label>
        <select name="target_channel" class="select-field">
          <option value="all">ุงููู (ูุงุชุณุงุจ ูุชูููุฌุฑุงู)</option>
          <option value="whatsapp">ูุงุชุณุงุจ ููุท</option>
          <option value="telegram">ุชูููุฌุฑุงู ููุท</option>
        </select>
      </div>

      <div class="mb-4">
        <label class="label">ูุต ุงูุฑุณุงูุฉ</label>
        <textarea
          name="message"
          rows="6"
          placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง..."
          required
          class="input-field"
        ></textarea>
      </div>

      <button type="submit" class="btn-primary w-full">๐ ุฅูุดุงุก ุงูุญููุฉ</button>
    </form>
  </div>
</div>

<script>
  function loadBroadcasts() {
    const tenantId = document.getElementById('tenant_select').value;
    document.getElementById('form_tenant_id').value = tenantId;
    if (tenantId) {
      htmx.ajax('GET', '/ui/broadcasts/list?tenant_id=' + tenantId, {
        target: '#broadcast-rows',
      });
    }
  }
</script>
{% endblock %}
